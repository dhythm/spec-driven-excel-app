# Quickstart Guide: スプレッドシートアプリケーション

## 概要
このガイドでは、スプレッドシートアプリケーションの基本的な使い方と、開発者向けのセットアップ手順を説明します。

## ユーザー向けクイックスタート

### 1. アプリケーションの起動
```bash
# ブラウザでアクセス
http://localhost:3000
```

### 2. 基本操作

#### 新規スプレッドシート作成
1. 「新規作成」ボタンをクリック
2. スプレッドシート名を入力
3. 「作成」をクリック

#### セルの編集
1. 編集したいセルをクリック
2. 値を入力
3. Enterキーまたは他のセルをクリックして確定

#### 数式の入力
```
=A1+B1          # 基本的な計算
=SUM(A1:A10)    # 範囲の合計
=AVERAGE(B1:B5) # 平均値
=COUNT(C1:C20)  # カウント
```

#### データの保存
- 自動保存: 変更後3秒で自動的にLocalStorageに保存
- 手動保存: Ctrl+S（Mac: Cmd+S）

#### CSV入出力
**エクスポート:**
1. ファイルメニュー → エクスポート → CSV
2. ファイル名を指定してダウンロード

**インポート:**
1. ファイルメニュー → インポート → CSV
2. ファイルを選択してアップロード

### 3. ショートカットキー
| 操作 | Windows/Linux | Mac |
|------|--------------|-----|
| コピー | Ctrl+C | Cmd+C |
| カット | Ctrl+X | Cmd+X |
| ペースト | Ctrl+V | Cmd+V |
| 元に戻す | Ctrl+Z | Cmd+Z |
| やり直し | Ctrl+Y | Cmd+Shift+Z |
| 保存 | Ctrl+S | Cmd+S |
| セル編集 | F2 | F2 |
| 編集キャンセル | Esc | Esc |

## 開発者向けセットアップ

### 前提条件
- Node.js 18.0.0以上
- npm 9.0.0以上
- Git

### 環境構築

#### 1. リポジトリのクローン
```bash
git clone <repository-url>
cd spec-driven-excel-app
```

#### 2. 依存関係のインストール
```bash
npm install
```

#### 3. 開発サーバーの起動
```bash
npm run dev
```

#### 4. ブラウザでアクセス
```
http://localhost:3000
```

### プロジェクト構造
```
frontend/
├── src/
│   ├── app/              # Next.js App Router
│   ├── components/       # UIコンポーネント
│   ├── lib/             # コアライブラリ
│   └── hooks/           # カスタムフック
├── tests/               # テストファイル
└── package.json
```

### 利用可能なスクリプト
```bash
npm run dev       # 開発サーバー起動
npm run build     # プロダクションビルド
npm run start     # プロダクションサーバー起動
npm run test      # テスト実行
npm run lint      # リント実行
npm run format    # コードフォーマット
```

## テスト実行ガイド

### ユニットテスト
```bash
npm run test:unit
```

### 統合テスト
```bash
npm run test:integration
```

### E2Eテスト
```bash
npm run test:e2e
```

### 全テスト実行
```bash
npm run test:all
```

## 検証シナリオ

### シナリオ1: 基本的なデータ入力と計算
1. 新規スプレッドシートを作成
2. A1セルに「10」を入力
3. B1セルに「20」を入力
4. C1セルに「=A1+B1」を入力
5. C1セルに「30」が表示されることを確認

### シナリオ2: CSV入出力
1. サンプルデータを入力
   - A1: 商品名, B1: 価格, C1: 数量
   - A2: りんご, B2: 100, C2: 5
   - A3: みかん, B3: 80, C3: 10
2. CSVエクスポートを実行
3. 新規スプレッドシートを作成
4. エクスポートしたCSVをインポート
5. データが正しく復元されることを確認

### シナリオ3: 大規模データのパフォーマンス
1. 100×100のグリッドにランダムデータを生成
2. スクロール操作がスムーズであることを確認
3. セル編集の応答時間が100ms以内であることを確認

### シナリオ4: エラーハンドリング
1. A1セルに「10」を入力
2. A2セルに「0」を入力
3. A3セルに「=A1/A2」を入力
4. 「#DIV/0!」エラーが表示されることを確認

### シナリオ5: データ永続化
1. スプレッドシートにデータを入力
2. ページをリロード
3. データが復元されることを確認
4. LocalStorageを確認してデータが保存されていることを確認

## トラブルシューティング

### 問題: データが保存されない
**解決方法:**
- ブラウザのLocalStorageが有効か確認
- プライベートブラウジングモードでないか確認
- LocalStorageの容量制限（5MB）を超えていないか確認

### 問題: 数式が計算されない
**解決方法:**
- 数式が「=」で始まっているか確認
- セル参照が正しいか確認
- 循環参照になっていないか確認

### 問題: CSVインポートが失敗する
**解決方法:**
- ファイルエンコーディング（UTF-8推奨）を確認
- 区切り文字（カンマ、セミコロン、タブ）を確認
- ファイルサイズが大きすぎないか確認

## サポート関数一覧

### 算術関数
- SUM(range): 合計
- AVERAGE(range): 平均
- COUNT(range): カウント
- MIN(range): 最小値
- MAX(range): 最大値

### 論理関数
- IF(condition, true_value, false_value): 条件分岐
- AND(...): 論理積
- OR(...): 論理和
- NOT(value): 否定

### テキスト関数
- CONCATENATE(...): 文字列結合
- UPPER(text): 大文字変換
- LOWER(text): 小文字変換
- LEN(text): 文字数

## パフォーマンス目標

| メトリクス | 目標値 | 測定方法 |
|-----------|--------|----------|
| 初期読み込み時間 | < 3秒 | Lighthouse |
| セル編集応答時間 | < 100ms | Performance API |
| 数式計算時間 | < 100ms | カスタム計測 |
| スクロールFPS | > 30fps | Chrome DevTools |
| メモリ使用量 | < 200MB | Chrome Task Manager |

## 今後の拡張予定

### Phase 2
- グラフ機能
- 条件付き書式
- フィルター/ソート機能

### Phase 3
- リアルタイム共同編集
- クラウドストレージ対応
- モバイル対応

### Phase 4
- マクロ/スクリプト機能
- プラグインシステム
- Excel/Google Sheets直接連携

---
*Version 0.1.0 - 2025-09-14*